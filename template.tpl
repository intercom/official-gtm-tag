___TERMS_OF_SERVICE___

By creating or modifying this file you agree to Google Tag Manager's Community
Template Gallery Developer Terms of Service available at
https://developers.google.com/tag-manager/gallery-tos (or such other URL as
Google may provide), as modified from time to time.


___INFO___

{
  "type": "TAG",
  "id": "cvt_temp_public_id",
  "version": 1,
  "securityGroups": [],
  "displayName": "Intercom",
  "categories": ["CHAT", "EMAIL_MARKETING", "LEAD_GENERATION", "MARKETING", "PERSONALIZATION", "SALES"],
  "brand": {
    "id": "brand_dummy",
    "displayName": "",
    "thumbnail": "data:image/png;base64,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"
  },
  "description": "Install and get the most of Intercom\u0027s Messenger on your website.",
  "containerContexts": [
    "WEB"
  ]
}


___TEMPLATE_PARAMETERS___

[
  {
    "type": "SELECT",
    "name": "method",
    "displayName": "Method",
    "macrosInSelect": false,
    "selectItems": [
      {
        "value": "install",
        "displayValue": "Install"
      },
      {
        "value": "boot",
        "displayValue": "Boot"
      },
      {
        "value": "shutdown",
        "displayValue": "Shutdown"
      },
      {
        "value": "update",
        "displayValue": "Update"
      },
      {
        "value": "hide",
        "displayValue": "Hide"
      },
      {
        "value": "show",
        "displayValue": "Show"
      },
      {
        "value": "showMesseges",
        "displayValue": "Show Messages"
      },
      {
        "value": "showNewMessage",
        "displayValue": "Show New Message"
      },
      {
        "value": "onHide",
        "displayValue": "On Hide"
      },
      {
        "value": "onShow",
        "displayValue": "On Show"
      },
      {
        "value": "onUnreadCountChange",
        "displayValue": "On Unread Count Change"
      },
      {
        "value": "trackEvent",
        "displayValue": "Track Event"
      },
      {
        "value": "startTour",
        "displayValue": "Start Tour"
      }
    ],
    "simpleValueType": true,
    "alwaysInSummary": true,
    "help": "Either simply install the Messenger or perform other methods as documented in https://developers.intercom.com/installing-intercom/docs/intercom-javascript",
    "valueValidators": [
      {
        "type": "NON_EMPTY"
      }
    ],
    "defaultValue": "install"
  },
  {
    "type": "TEXT",
    "name": "app_id",
    "displayName": "Workspace ID",
    "simpleValueType": true,
    "alwaysInSummary": false,
    "notSetText": "Workspace ID is required for Messenger installation",
    "help": "Your App ID is available in Intercom in Settings -\u003e Installation -\u003e Web",
    "enablingConditions": [
      {
        "paramName": "method",
        "paramValue": "install",
        "type": "EQUALS"
      },
      {
        "paramName": "method",
        "paramValue": "update",
        "type": "EQUALS"
      },
      {
        "paramName": "method",
        "paramValue": "boot",
        "type": "EQUALS"
      }
    ]
  },
  {
    "type": "CHECKBOX",
    "name": "log_impression",
    "checkboxText": "Log impression at the current URL",
    "simpleValueType": true,
    "displayName": "Log Impression",
    "enablingConditions": [
      {
        "paramName": "method",
        "paramValue": "update",
        "type": "EQUALS"
      }
    ],
    "help": "When checked, this will add a record showing that the user has visited this URL"
  },
  {
    "type": "GROUP",
    "name": "data_attributes",
    "displayName": "Data Attributes",
    "groupStyle": "ZIPPY_CLOSED",
    "subParams": [
      {
        "type": "LABEL",
        "name": "data_attributes_help",
        "displayName": "These attributes are used to update user/lead information. \nPlease see https://developers.intercom.com/installing-intercom/docs/javascript-api-attributes-objects#section-data-attributes for detailed information."
      },
      {
        "type": "TEXT",
        "name": "email",
        "displayName": "User Email",
        "simpleValueType": true,
        "help": "(Optional) Bind this to a variable that would hold the email address of the currently logged-in user (Only applicable to users). \nImportant: Do not enter a specific email address, as this address would apply to all your visitors and skew your data.",
        "valueValidators": [],
        "valueHint": "Choose a variable"
      },
      {
        "type": "TEXT",
        "name": "user_id",
        "displayName": "User ID",
        "simpleValueType": true,
        "help": "(Optional) Bind this to a variable that would hold the \"User ID\" value of the currently logged-in user (Only applicable to users). \nImportant: Do not enter a specific user ID, as this ID would apply to all your visitors and skew your data.",
        "valueValidators": [],
        "valueHint": "Choose a variable"
      },
      {
        "type": "TEXT",
        "name": "created_at",
        "displayName": "User Sign-Up Timestamp",
        "simpleValueType": true,
        "help": "(Optional) Bind this to a variable that would hold the Unix timestamp (in seconds) when the user signed up to your app (Only applicable to users)",
        "valueValidators": [
          {
            "type": "POSITIVE_NUMBER"
          }
        ],
        "valueHint": "Choose a variable",
        "valueUnit": "Unix timestamp (in seconds)"
      },
      {
        "type": "TEXT",
        "name": "name",
        "displayName": "Name",
        "simpleValueType": true,
        "help": "(Optional) Bind this to a variable that would hold name of the current user/lead.\nImportant: Do not enter a specific name, as this would apply to all your visitors/users and skew your data.",
        "valueValidators": [],
        "valueHint": "Choose a variable"
      },
      {
        "type": "TEXT",
        "name": "phone",
        "displayName": "Phone Number",
        "simpleValueType": true,
        "help": "(Optional) Bind this to a variable that would hold phone number of the current user/lead.\nImportant: Do not enter a specific phone number, as this number would apply to all your visitors/users and skew your data.",
        "valueValidators": [],
        "valueHint": "Choose a variable"
      },
      {
        "type": "TEXT",
        "name": "user_hash",
        "displayName": "User Hash (Identity Verification)",
        "simpleValueType": true,
        "help": "(Optional) Bind this to a variable that would hold the \"user hash\" of the currently logged-in user (Only applicable to users).\nSee more details here: https://docs.intercom.com/configure-intercom-for-your-product-or-site/staying-secure/enable-identity-verification-on-your-web-product",
        "valueValidators": [],
        "valueHint": "Choose a variable"
      }
    ],
    "enablingConditions": [
      {
        "paramName": "method",
        "paramValue": "install",
        "type": "EQUALS"
      },
      {
        "paramName": "method",
        "paramValue": "update",
        "type": "EQUALS"
      },
      {
        "paramName": "method",
        "paramValue": "boot",
        "type": "EQUALS"
      }
    ],
    "help": "(Optional) These attributes are used to update user/lead information. Please see https://developers.intercom.com/installing-intercom/docs/javascript-api-attributes-objects#section-data-attributes for detailed information."
  },
  {
    "type": "GROUP",
    "name": "custom_attributes_section",
    "displayName": "Custom Data Attributes",
    "groupStyle": "ZIPPY_CLOSED",
    "subParams": [
      {
        "type": "SIMPLE_TABLE",
        "name": "custom_attributes",
        "displayName": "Custom Attributes",
        "simpleTableColumns": [
          {
            "defaultValue": "",
            "displayName": "Attribute Name",
            "name": "attr_key",
            "type": "TEXT"
          },
          {
            "defaultValue": "",
            "displayName": "Attribute Value",
            "name": "attr_value",
            "type": "TEXT"
          }
        ],
        "enablingConditions": [],
        "help": ""
      }
    ],
    "enablingConditions": [
      {
        "paramName": "method",
        "paramValue": "install",
        "type": "EQUALS"
      },
      {
        "paramName": "method",
        "paramValue": "update",
        "type": "EQUALS"
      },
      {
        "paramName": "method",
        "paramValue": "boot",
        "type": "EQUALS"
      }
    ]
  },
  {
    "type": "TEXT",
    "name": "prepopulated_message",
    "displayName": "Pre-Populate Message",
    "simpleValueType": true,
    "enablingConditions": [
      {
        "paramName": "method",
        "paramValue": "showNewMessage",
        "type": "EQUALS"
      }
    ],
    "help": "(Optional) Pre-populate the message composer (only possible with Intercom\u0027s Inbox Essential \u0026 Pro product)"
  },
  {
    "type": "TEXT",
    "name": "callback_event_name",
    "displayName": "Event Name",
    "simpleValueType": true,
    "notSetText": "Event name is required for this method",
    "enablingConditions": [
      {
        "paramName": "method",
        "paramValue": "onHide",
        "type": "EQUALS"
      },
      {
        "paramName": "method",
        "paramValue": "onShow",
        "type": "EQUALS"
      },
      {
        "paramName": "method",
        "paramValue": "onUnreadCountChange",
        "type": "EQUALS"
      }
    ],
    "help": "Trigger a dataLayer event when we hide/show the messenger or whenever the current number of unread messages changes.",
    "valueValidators": [
      {
        "type": "NON_EMPTY"
      }
    ]
  },
  {
    "type": "TEXT",
    "name": "tour_id",
    "displayName": "Tour ID",
    "simpleValueType": true,
    "notSetText": "You need to call this method with the id of the tour you wish to show.",
    "enablingConditions": [
      {
        "paramName": "method",
        "paramValue": "startTour",
        "type": "EQUALS"
      }
    ],
    "help": "The id of the tour you wish to show. \nThe id of the tour can be found in the “Use tour everywhere” section of the tour editor.",
    "valueValidators": [
      {
        "type": "POSITIVE_NUMBER"
      }
    ]
  },
  {
    "type": "TEXT",
    "name": "event_name",
    "displayName": "Event Name",
    "simpleValueType": true,
    "notSetText": "Event name is required for this method",
    "enablingConditions": [
      {
        "paramName": "method",
        "paramValue": "trackEvent",
        "type": "EQUALS"
      }
    ],
    "valueValidators": [
      {
        "type": "NON_EMPTY"
      }
    ]
  },
  {
    "type": "SIMPLE_TABLE",
    "name": "event_attributes",
    "displayName": "Event Attributes",
    "simpleTableColumns": [
      {
        "defaultValue": "",
        "displayName": "Attribute Name",
        "name": "attr_key",
        "type": "TEXT"
      },
      {
        "defaultValue": "",
        "displayName": "Attribute Value",
        "name": "attr_value",
        "type": "TEXT"
      }
    ],
    "enablingConditions": [
      {
        "paramName": "method",
        "paramValue": "trackEvent",
        "type": "EQUALS"
      }
    ],
    "help": "(Optional) You can add custom information to events in the form of event metadata."
  }
]


___SANDBOXED_JS_FOR_WEB_TEMPLATE___

// Enter your template code here.
const log = require('logToConsole');
const encodeUriComponent = require('encodeUriComponent');
const copyFromWindow = require('copyFromWindow');
const callInWindow = require('callInWindow');
const setInWindow = require('setInWindow');
const injectScript = require('injectScript');
const makeInteger = require('makeInteger');
const createQueue = require('createQueue');
const dataLayerPush = createQueue('dataLayer');
const makeTableMap = require('makeTableMap');
log('data =', data);

const DATA_ATTRS = ['email', 'user_id', 'created_at', 'name', 'phone', 'unsubscribed_from_emails', 'language_override', 'avatar', 'user_hash', 'company', 'companies'];

function getDataAttrs(data) {
  var data_attrs = DATA_ATTRS.reduce( (res, attr) => {
    if (data[attr]) {
        res[attr] = data[attr];
    }
    return res;
  }, {});
  return data_attrs;
}

function setOrUpdateIntercomSettings(data) {
  var data_attrs = getDataAttrs(data);
  data_attrs.app_id = data.app_id;
  var settings = copyFromWindow('intercomSettings') || {};
  for (var k in data_attrs) {
    settings[k] = data_attrs[k];
  }
  setInWindow('intercomSettings', settings);
  return settings;
}

function setPlaceholderEventQueue() {
  log("setPlaceholderEventQueue");
  var i=function(){
    i.c(arguments);
  };
  i.q=[];
  i.c=function(args){
    i.q.push(args);
  };
  setInWindow('Intercom', i, true);
}

function onLoadSuccess() {
  var ic = copyFromWindow("Intercom");
  log("Intercom loaded:", ic);
  data.gtmOnSuccess();
}

function onLoadFailure() {
  log("Failed loading Intercom");
    data.gtmOnFailure();
}

function updateMessenger(intercomSettings) {
  log("Updating Messenger settings");
  callInWindow('Intercom', 'reattach_activator');
  callInWindow('Intercom', 'update', intercomSettings);
}

function loadMessenger() {
  var app_id = data.app_id;
  if (!app_id) {
    data.gtmOnFailure();
  }
  const url = 'https://widget.intercom.io/widget/' + encodeUriComponent(app_id);
  injectScript(url, onLoadSuccess, onLoadFailure, url);
}

function install(ic, settings) {
   loadMessenger();
}

function update(ic, settings) {
  log("Updating Messenger settings: ", settings);
  if (data.log_impression) {
    callInWindow('Intercom', 'update', settings);
  } else {
    callInWindow('Intercom', 'update');
  }
  data.gtmOnSuccess();
}

function boot(ic, settings) {
  log("Booting Messenger, settings: ", settings);
  callInWindow('Intercom', 'boot', settings);
  data.gtmOnSuccess();
}

function invokeMethod(method) {
  log("Invoking method: ", method);
  callInWindow('Intercom', method);
  data.gtmOnSuccess();
}

function showNewMessage(ic, settings) {
  var prepopulated_message = data.prepopulated_message;
  callInWindow('Intercom', data.method);  
  data.gtmOnSuccess();
}

function registerCallback(ic, settings) {
  var method = data.method;
  var callbackEventName = data.callback_event_name;
  log("registering callback: ", method, callbackEventName);
  if (!method || !callbackEventName) {
    data.gtmOnFailure();
  }
  var callback = function() {
    log("Callback fired!");
    dataLayerPush({'event': callbackEventName});

  };
  //callInWindow('Intercom', data.method, callback);
  ic(method, callback);
  data.gtmOnSuccess();
}

function trackEvent(ic, settings) {
  var event_name = data.event_name;
  var event_attrs = makeTableMap(data.event_attributes, 'attr_key', 'attr_value') || {};
  callInWindow('Intercom', data.method, event_name, event_attrs);
  data.gtmOnSuccess();
}

function startTour(ic, settings) {
  var tour_id = makeInteger(data.tour_id);
  log('startTour: ', tour_id);
  callInWindow('Intercom', data.method, tour_id);
  data.gtmOnSuccess();
}
  

var methodMap = {
  install: install,
  update: update,
  boot: boot,
  shutdown: (ic, settings) => invokeMethod('shutdown'),
  hide: (ic, settings) => invokeMethod('hide'),
  show: (ic, settings) => invokeMethod('show'),
  showMessages: (ic, settings) => invokeMethod('showMessages'),
  showNewMessage: showNewMessage,
  onShow: registerCallback,
  onHide: registerCallback,
  onUnreadCountChange: registerCallback,
  trackEvent: trackEvent,
  startTour: startTour,
};

function main() {
    let settings = setOrUpdateIntercomSettings(data);
    var ic = copyFromWindow("Intercom");
    log("current Intercom: ", ic);
    if (typeof ic !== "function") {
      setPlaceholderEventQueue();
    }
    let methodFunc = methodMap[data.method];
    methodFunc(ic, settings);
}

main();
// Call data.gtmOnSuccess when the tag is finished.
//data.gtmOnSuccess();


___WEB_PERMISSIONS___

[
  {
    "instance": {
      "key": {
        "publicId": "logging",
        "versionId": "1"
      },
      "param": [
        {
          "key": "environments",
          "value": {
            "type": 1,
            "string": "all"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "access_globals",
        "versionId": "1"
      },
      "param": [
        {
          "key": "keys",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "Intercom"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "intercomSettings"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": false
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "dataLayer"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "inject_script",
        "versionId": "1"
      },
      "param": [
        {
          "key": "urls",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "https://widget.intercom.io/widget/*"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  }
]


___TESTS___

scenarios:
- name: Sanity
  code: |-
    const mockData = {
      app_id: 'g0yyb1fs',
    };

    // Call runCode to run the template's code.
    runCode(mockData);

    // Verify that the tag finished successfully.
    assertApi('gtmOnSuccess').wasCalled();


___NOTES___

Created on 7/14/2020, 3:35:53 PM


